{% extends "NexusCoreBundle::layout.html.twig" %}

{% block stylesheets %}
    {{ parent() }}

    {% stylesheets filter='cssrewrite, ?yui_css' output='css/minify/*.css'
    '@NexusCoreBundle/Resources/public/css/index.css'
    %}
        <link rel="stylesheet" href="{{ asset_url }}" type="text/css" />
    {% endstylesheets %}
{% endblock %}

{% block content %}
<div class="row text-center">
	<h1>Welcome {{ user.username }} !</h1>
</div>
<div class="row" style="margin-top: 20px;">
    <div class="col-sm-12 col-md-8">
        <div class="row">
            <div class="col-sm-6 col-md-6">    
                <div class="panel panel-default">
                    <div class="panel-heading"><h3 class="panel-title"><strong>Character sheet</strong></h3></div>
                    <div class="panel-body">
                            <div class="row">
                                <div class="col-xs-4">
                                    <div id="character-avatar">
                                        <div id="character-damage" class="damage-taken" style="display: none;"></div>
                                        <img src="{{ asset('images/NexusCharacter/'~user.character.avatar) }}" class="img-responsive img-avatar" />
                                    </div>
                                </div>
                                <div class="col-xs-4 text-center">
                                    <p class="character-name">{{ user.username }}</p>
                                    <p class="character-level">Level {{ user.character.level }}</p>
                                </div>
                                <div class="col-xs-4">
                                    <p>
                                        <img src="{{ asset('bundles/nexuscore/images/power.png') }}" alt="Power" title="Power" class="img-power img-char-sheet" /> 
                                        <span class="character-power">{{ user.character.power }}</span>
                                    </p>
                                    <p>
                                        <img src="{{ asset('bundles/nexuscore/images/attackSpeed.png') }}" alt="Attack Speed" title="Attack Speed" class="img-attack-speed img-char-sheet" /> 
                                        <span class="character-attack-speed">{{ user.character.attackSpeed }}
                                    </p>                            
                                    <p>
                                        <img src="{{ asset('bundles/nexuscore/images/dps.png') }}" alt="DPS" title="DPS" class="img-dps img-char-sheet" />
                                        <span class="character-dps">{{ user.character.dps }}</span>
                                    </p>
                                </div>                                                
                            </div>
                            <div class="row">
                                <div class="col-xs-12 txt-center">
                                    <img src="{{ asset('bundles/nexuscore/images/health.png') }}" class="img-health img-char-sheet" />
                                    <div class="progress">
                                      <div class="progress-bar progress-bar-danger" id="character-progress-hp" role="progressbar" aria-valuenow="{{ user.character.health }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ user.character.health }}%; color: black;">
                                        <span class="progress-wrapper">
                                            <span class="character-hp-current">{{ user.character.health }}</span> / <span class="character-hp-total">100</span>
                                        </span>                             
                                      </div>
                                    </div>
                                    <img src="{{ asset('bundles/nexuscore/images/xp.png') }}" class="img-xp img-char-sheet" />                      
                                    <div class="progress progress-last">
                                      <div class="progress-bar" role="progressbar" id="character-progress-xp" aria-valuenow="{{ user.character.percentlevel }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ user.character.percentlevel }}%;">
                                            <span class="progress-wrapper">
                                                <span class="character-xp-current">{{ user.character.getExperienceShort }}</span> / <span class="character-xp-total">{{ user.character.getExperienceShortMax }}</span>
                                            </span>                              
                                      </div>
                                    </div>
                                </div>
                            </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-6 col-md-6">
                <div class="panel panel-default">
                    <div class="panel-heading"><h3 class="panel-title"><strong>Fight (<span class="character-fight-number">{{ user.character.fight }}</span>)</strong></h3></div>
                    <div class="panel-body">
                            <div class="row">
                                <div class="col-xs-4">
                                    <div id="monster-avatar">
                                        <div id="monster-damage" class="damage-taken" style="display: none;"></div>
                                        <img src="{{ asset('images/NexusMonster/nodirector.jpg') }}" class="img-responsive img-monster-avatar" />
                                    </div>
                                </div>
                                <div class="col-xs-4 text-center">
                                    <p class="monster-name">????</p>
                                    <p class="monster-level">Level ??</p>
                                    <p class="monster-type">Level ??</p>
                                </div>
                                <div class="col-xs-4">
                                    <p>
                                        <img src="{{ asset('bundles/nexuscore/images/power.png') }}" alt="Power" title="Power" class="img-power img-char-sheet" />
                                        <span class="monster-power">??</span>
                                    </p>
                                    <p>
                                        <img src="{{ asset('bundles/nexuscore/images/attackSpeed.png') }}" alt="Attack Speed" title="Attack Speed" class="img-attack-speed img-char-sheet" /> 
                                        <span class="monster-attack-speed">??</span>
                                    </p>                            
                                    <p>
                                        <img src="{{ asset('bundles/nexuscore/images/dps.png') }}" alt="DPS" title="DPS" class="img-dps img-char-sheet" />
                                        <span class="monster-dps">??</span>
                                    </p>
                                </div>                                                
                            </div>
                            <div class="row">
                                <div class="col-xs-12 txt-center">
                                    <img src="{{ asset('bundles/nexuscore/images/health.png') }}" class="img-health img-char-sheet" />
                                    <div class="progress">
                                      <div class="progress-bar progress-bar-danger" id="monster-progress-hp" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%; color: black;">
                                        <span class="progress-wrapper">
                                            <span class="monster-hp-current">??</span> / <span class="monster-hp-total">??</span>
                                        </span>                           
                                      </div>
                                    </div>
                                    <img src="{{ asset('bundles/nexuscore/images/xp.png') }}" class="img-xp img-char-sheet" />                      
                                    <span class="monster-xp">??</span> xp
                                </div>
                            </div>            
                    </div>
                </div>
            </div>
        </div>

        {% if user.character.fight > 0 %}
            <div class="row">
                <div class="col-sm-12 col-md-12 text-center">
                    <button autocomplete = "off" type="button" class="btn btn-default btn-lg" id="fight-monster" data-loading-text="Fighting...">
                        <i class="fa fa-bolt"></i> &nbsp;Fight
                    </button>
                </div>
            </div>
        {% endif %}

        <div class="row">
            <div class="col-sm-12">
                <div id="fight-result" class="alert hide"></div>
            </div>
        </div>

    </div>
    <div class="col-sm-6 col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading"><h3 class="panel-title"><strong>Leaderboard</strong></h3></div>
            <div class="panel-body">
                <div class="table-responsive">
    				<table class="table table-striped table-hover">
    					<thead>
    						<tr>
    							<th>#</th>
    							<th>Username</th>
    							<th>Level</th>
    							<th>Experience</th>
    						</tr>
    					</thead>
    					<tbody>
    						{% for character in leaderboard %}
    							<tr>
    								<td>{{ loop.index }}.</td>
    								<td>{{ character.user.username }}</td>
    								<td>{{ character.level }}</td>
    								<td>{{ character.experience }}</td>
    							</tr>
    						{% endfor %}
    					</tbody>
    				</table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script type="text/javascript">
        var TWIG = {};
        TWIG.icon_monster_path   = "{{ asset('images/NexusMonster/%icon%')}}";
    </script>

    {% javascripts filter='?yui_js' output='js/minify/*.js'
        '@NexusCoreBundle/Resources/public/js/fight.js'
    %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}